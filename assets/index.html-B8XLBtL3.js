import{_ as s}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as i,o as a,e as n}from"./app-BUJ2iQsf.js";const h={},e=n(`<div class="hint-container note"><p class="hint-container-title">ç›¸å…³å‚è€ƒæ–‡ç« ğŸ‰</p><ul><li><a href="https://tech.meituan.com/2016/12/02/redblack-tree.html" target="_blank" rel="noopener noreferrer">çº¢é»‘æ ‘æ·±å…¥å‰–æåŠJavaå®ç°</a></li></ul></div><blockquote><p>ä»¥ä¸‹å†…å®¹å‡ºè‡ª<a href="https://javaguide.cn/java/collection/java-collection-questions-02.html#map-%E6%8E%A5%E5%8F%A3" target="_blank" rel="noopener noreferrer">JavaGuide</a>ã€‚</p></blockquote><h2 id="hashmap-å’Œ-hashtable-çš„åŒºåˆ«" tabindex="-1"><a class="header-anchor" href="#hashmap-å’Œ-hashtable-çš„åŒºåˆ«"><span>HashMap å’Œ Hashtable çš„åŒºåˆ«</span></a></h2><ol><li><strong>çº¿ç¨‹æ˜¯å¦å®‰å…¨ï¼š</strong> <code>HashMap</code> æ˜¯éçº¿ç¨‹å®‰å…¨çš„ï¼Œ<code>Hashtable</code> æ˜¯çº¿ç¨‹å®‰å…¨çš„,å› ä¸º <code>Hashtable</code> å†…éƒ¨çš„æ–¹æ³•åŸºæœ¬éƒ½ç»è¿‡<code>synchronized</code> ä¿®é¥°ã€‚ï¼ˆå¦‚æœä½ è¦ä¿è¯çº¿ç¨‹å®‰å…¨çš„è¯å°±ä½¿ç”¨ <code>ConcurrentHashMap</code> å§ï¼ï¼‰ï¼›</li><li><strong>æ•ˆç‡ï¼š</strong> å› ä¸ºçº¿ç¨‹å®‰å…¨çš„é—®é¢˜ï¼Œ<code>HashMap</code> è¦æ¯” <code>Hashtable</code> æ•ˆç‡é«˜ä¸€ç‚¹ã€‚å¦å¤–ï¼Œ<code>Hashtable</code> åŸºæœ¬è¢«æ·˜æ±°ï¼Œä¸è¦åœ¨ä»£ç ä¸­ä½¿ç”¨å®ƒï¼›</li><li><strong>å¯¹ Null key å’Œ Null value çš„æ”¯æŒï¼š</strong> <code>HashMap</code> å¯ä»¥å­˜å‚¨ null çš„ key å’Œ valueï¼Œä½† null ä½œä¸ºé”®åªèƒ½æœ‰ä¸€ä¸ªï¼Œnull ä½œä¸ºå€¼å¯ä»¥æœ‰å¤šä¸ªï¼›Hashtable ä¸å…è®¸æœ‰ null é”®å’Œ null å€¼ï¼Œå¦åˆ™ä¼šæŠ›å‡º <code>NullPointerException</code>ã€‚</li><li><strong>åˆå§‹å®¹é‡å¤§å°å’Œæ¯æ¬¡æ‰©å……å®¹é‡å¤§å°çš„ä¸åŒ ï¼š</strong> â‘  åˆ›å»ºæ—¶å¦‚æœä¸æŒ‡å®šå®¹é‡åˆå§‹å€¼ï¼Œ<code>Hashtable</code> é»˜è®¤çš„åˆå§‹å¤§å°ä¸º 11ï¼Œä¹‹åæ¯æ¬¡æ‰©å……ï¼Œå®¹é‡å˜ä¸ºåŸæ¥çš„ 2n+1ã€‚<code>HashMap</code> é»˜è®¤çš„åˆå§‹åŒ–å¤§å°ä¸º 16ã€‚ä¹‹åæ¯æ¬¡æ‰©å……ï¼Œå®¹é‡å˜ä¸ºåŸæ¥çš„ 2 å€ã€‚â‘¡ åˆ›å»ºæ—¶å¦‚æœç»™å®šäº†å®¹é‡åˆå§‹å€¼ï¼Œé‚£ä¹ˆ Hashtable ä¼šç›´æ¥ä½¿ç”¨ä½ ç»™å®šçš„å¤§å°ï¼Œè€Œ <code>HashMap</code> ä¼šå°†å…¶æ‰©å……ä¸º 2 çš„å¹‚æ¬¡æ–¹å¤§å°ï¼ˆ<code>HashMap</code> ä¸­çš„<code>tableSizeFor()</code>æ–¹æ³•ä¿è¯ï¼Œä¸‹é¢ç»™å‡ºäº†æºä»£ç ï¼‰ã€‚ä¹Ÿå°±æ˜¯è¯´ <code>HashMap</code> æ€»æ˜¯ä½¿ç”¨ 2 çš„å¹‚ä½œä¸ºå“ˆå¸Œè¡¨çš„å¤§å°,åé¢ä¼šä»‹ç»åˆ°ä¸ºä»€ä¹ˆæ˜¯ 2 çš„å¹‚æ¬¡æ–¹ã€‚</li><li><strong>åº•å±‚æ•°æ®ç»“æ„ï¼š</strong> JDK1.8 ä»¥åçš„ <code>HashMap</code> åœ¨è§£å†³å“ˆå¸Œå†²çªæ—¶æœ‰äº†è¾ƒå¤§çš„å˜åŒ–ï¼Œå½“é“¾è¡¨é•¿åº¦å¤§äºé˜ˆå€¼ï¼ˆé»˜è®¤ä¸º 8ï¼‰ï¼ˆå°†é“¾è¡¨è½¬æ¢æˆçº¢é»‘æ ‘å‰ä¼šåˆ¤æ–­ï¼Œå¦‚æœå½“å‰æ•°ç»„çš„é•¿åº¦å°äº 64ï¼Œé‚£ä¹ˆä¼šé€‰æ‹©å…ˆè¿›è¡Œæ•°ç»„æ‰©å®¹ï¼Œè€Œä¸æ˜¯è½¬æ¢ä¸ºçº¢é»‘æ ‘ï¼‰æ—¶ï¼Œå°†é“¾è¡¨è½¬åŒ–ä¸ºçº¢é»‘æ ‘ï¼Œä»¥å‡å°‘æœç´¢æ—¶é—´ã€‚Hashtable æ²¡æœ‰è¿™æ ·çš„æœºåˆ¶ã€‚</li></ol><p><strong><code>HashMap</code> ä¸­å¸¦æœ‰åˆå§‹å®¹é‡çš„æ„é€ å‡½æ•°ï¼š</strong></p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="--shiki-light:#393a34;--shiki-dark:#e1e4e8;--shiki-light-bg:#ffffff;--shiki-dark-bg:#24292e;"><pre class="shiki shiki-themes vitesse-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#F97583;">    public</span><span style="--shiki-light:#59873A;--shiki-dark:#B392F0;"> HashMap</span><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#AB5959;--shiki-dark:#F97583;">int</span><span style="--shiki-light:#393A34;--shiki-dark:#E1E4E8;"> initialCapacity</span><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#AB5959;--shiki-dark:#F97583;"> float</span><span style="--shiki-light:#393A34;--shiki-dark:#E1E4E8;"> loadFactor</span><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;">)</span><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#F97583;">        if</span><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#393A34;--shiki-dark:#E1E4E8;">initialCapacity </span><span style="--shiki-light:#AB5959;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#2F798A;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#F97583;">            throw</span><span style="--shiki-light:#1E754F;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#59873A;--shiki-dark:#B392F0;"> IllegalArgumentException</span><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#B5695977;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#9ECBFF;">Illegal initial capacity: </span><span style="--shiki-light:#B5695977;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#AB5959;--shiki-dark:#F97583;"> +</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#E1E4E8;">                                               initialCapacity</span><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#F97583;">        if</span><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#393A34;--shiki-dark:#E1E4E8;">initialCapacity </span><span style="--shiki-light:#AB5959;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#393A34;--shiki-dark:#E1E4E8;"> MAXIMUM_CAPACITY</span><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#E1E4E8;">            initialCapacity </span><span style="--shiki-light:#999999;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#393A34;--shiki-dark:#E1E4E8;"> MAXIMUM_CAPACITY</span><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#F97583;">        if</span><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#393A34;--shiki-dark:#E1E4E8;">loadFactor </span><span style="--shiki-light:#AB5959;--shiki-dark:#F97583;">&lt;=</span><span style="--shiki-light:#2F798A;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#AB5959;--shiki-dark:#F97583;"> ||</span><span style="--shiki-light:#B07D48;--shiki-dark:#E1E4E8;"> Float</span><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#59873A;--shiki-dark:#B392F0;">isNaN</span><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#393A34;--shiki-dark:#E1E4E8;">loadFactor</span><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;">))</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#F97583;">            throw</span><span style="--shiki-light:#1E754F;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#59873A;--shiki-dark:#B392F0;"> IllegalArgumentException</span><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#B5695977;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#9ECBFF;">Illegal load factor: </span><span style="--shiki-light:#B5695977;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#AB5959;--shiki-dark:#F97583;"> +</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#E1E4E8;">                                               loadFactor</span><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#A65E2B;--shiki-dark:#79B8FF;">        this</span><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#B07D48;--shiki-dark:#E1E4E8;">loadFactor</span><span style="--shiki-light:#999999;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#393A34;--shiki-dark:#E1E4E8;"> loadFactor</span><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#A65E2B;--shiki-dark:#79B8FF;">        this</span><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#B07D48;--shiki-dark:#E1E4E8;">threshold</span><span style="--shiki-light:#999999;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#59873A;--shiki-dark:#B392F0;"> tableSizeFor</span><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#393A34;--shiki-dark:#E1E4E8;">initialCapacity</span><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#F97583;">     public</span><span style="--shiki-light:#59873A;--shiki-dark:#B392F0;"> HashMap</span><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#AB5959;--shiki-dark:#F97583;">int</span><span style="--shiki-light:#393A34;--shiki-dark:#E1E4E8;"> initialCapacity</span><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;">)</span><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#A65E2B;--shiki-dark:#79B8FF;">        this</span><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#393A34;--shiki-dark:#E1E4E8;">initialCapacity</span><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#393A34;--shiki-dark:#E1E4E8;"> DEFAULT_LOAD_FACTOR</span><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;">    }</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸‹é¢è¿™ä¸ªæ–¹æ³•ä¿è¯äº† <code>HashMap</code> æ€»æ˜¯ä½¿ç”¨ 2 çš„å¹‚ä½œä¸ºå“ˆå¸Œè¡¨çš„å¤§å°ã€‚</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="--shiki-light:#393a34;--shiki-dark:#e1e4e8;--shiki-light-bg:#ffffff;--shiki-dark-bg:#24292e;"><pre class="shiki shiki-themes vitesse-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#6A737D;">    /**</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#6A737D;">     * Returns a power of two size for the given target capacity.</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#6A737D;">     */</span></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#F97583;">    static</span><span style="--shiki-light:#AB5959;--shiki-dark:#F97583;"> final</span><span style="--shiki-light:#AB5959;--shiki-dark:#F97583;"> int</span><span style="--shiki-light:#59873A;--shiki-dark:#B392F0;"> tableSizeFor</span><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#AB5959;--shiki-dark:#F97583;">int</span><span style="--shiki-light:#393A34;--shiki-dark:#E1E4E8;"> cap</span><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;">)</span><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#F97583;">        int</span><span style="--shiki-light:#B07D48;--shiki-dark:#E1E4E8;"> n</span><span style="--shiki-light:#999999;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#393A34;--shiki-dark:#E1E4E8;"> cap </span><span style="--shiki-light:#AB5959;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#2F798A;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#E1E4E8;">        n </span><span style="--shiki-light:#999999;--shiki-dark:#F97583;">|=</span><span style="--shiki-light:#393A34;--shiki-dark:#E1E4E8;"> n </span><span style="--shiki-light:#AB5959;--shiki-dark:#F97583;">&gt;&gt;&gt;</span><span style="--shiki-light:#2F798A;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#E1E4E8;">        n </span><span style="--shiki-light:#999999;--shiki-dark:#F97583;">|=</span><span style="--shiki-light:#393A34;--shiki-dark:#E1E4E8;"> n </span><span style="--shiki-light:#AB5959;--shiki-dark:#F97583;">&gt;&gt;&gt;</span><span style="--shiki-light:#2F798A;--shiki-dark:#79B8FF;"> 2</span><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#E1E4E8;">        n </span><span style="--shiki-light:#999999;--shiki-dark:#F97583;">|=</span><span style="--shiki-light:#393A34;--shiki-dark:#E1E4E8;"> n </span><span style="--shiki-light:#AB5959;--shiki-dark:#F97583;">&gt;&gt;&gt;</span><span style="--shiki-light:#2F798A;--shiki-dark:#79B8FF;"> 4</span><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#E1E4E8;">        n </span><span style="--shiki-light:#999999;--shiki-dark:#F97583;">|=</span><span style="--shiki-light:#393A34;--shiki-dark:#E1E4E8;"> n </span><span style="--shiki-light:#AB5959;--shiki-dark:#F97583;">&gt;&gt;&gt;</span><span style="--shiki-light:#2F798A;--shiki-dark:#79B8FF;"> 8</span><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#E1E4E8;">        n </span><span style="--shiki-light:#999999;--shiki-dark:#F97583;">|=</span><span style="--shiki-light:#393A34;--shiki-dark:#E1E4E8;"> n </span><span style="--shiki-light:#AB5959;--shiki-dark:#F97583;">&gt;&gt;&gt;</span><span style="--shiki-light:#2F798A;--shiki-dark:#79B8FF;"> 16</span><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#F97583;">        return</span><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#393A34;--shiki-dark:#E1E4E8;">n </span><span style="--shiki-light:#AB5959;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#2F798A;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;">)</span><span style="--shiki-light:#1E754F;--shiki-dark:#F97583;"> ?</span><span style="--shiki-light:#2F798A;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#1E754F;--shiki-dark:#F97583;"> :</span><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#393A34;--shiki-dark:#E1E4E8;">n </span><span style="--shiki-light:#AB5959;--shiki-dark:#F97583;">&gt;=</span><span style="--shiki-light:#393A34;--shiki-dark:#E1E4E8;"> MAXIMUM_CAPACITY</span><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;">)</span><span style="--shiki-light:#1E754F;--shiki-dark:#F97583;"> ?</span><span style="--shiki-light:#393A34;--shiki-dark:#E1E4E8;"> MAXIMUM_CAPACITY </span><span style="--shiki-light:#1E754F;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#393A34;--shiki-dark:#E1E4E8;"> n </span><span style="--shiki-light:#AB5959;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#2F798A;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;">    }</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="hashmap-å’Œ-hashset-åŒºåˆ«" tabindex="-1"><a class="header-anchor" href="#hashmap-å’Œ-hashset-åŒºåˆ«"><span>HashMap å’Œ HashSet åŒºåˆ«</span></a></h2><p>å¦‚æœä½ çœ‹è¿‡ <code>HashSet</code> æºç çš„è¯å°±åº”è¯¥çŸ¥é“ï¼š<code>HashSet</code> åº•å±‚å°±æ˜¯åŸºäº <code>HashMap</code> å®ç°çš„ã€‚ï¼ˆ<code>HashSet</code> çš„æºç éå¸¸éå¸¸å°‘ï¼Œå› ä¸ºé™¤äº† <code>clone()</code>ã€<code>writeObject()</code>ã€<code>readObject()</code>æ˜¯ <code>HashSet</code> è‡ªå·±ä¸å¾—ä¸å®ç°ä¹‹å¤–ï¼Œå…¶ä»–æ–¹æ³•éƒ½æ˜¯ç›´æ¥è°ƒç”¨ <code>HashMap</code> ä¸­çš„æ–¹æ³•ã€‚</p><table><thead><tr><th style="text-align:center;"><code>HashMap</code></th><th style="text-align:center;"><code>HashSet</code></th></tr></thead><tbody><tr><td style="text-align:center;">å®ç°äº† <code>Map</code> æ¥å£</td><td style="text-align:center;">å®ç° <code>Set</code> æ¥å£</td></tr><tr><td style="text-align:center;">å­˜å‚¨é”®å€¼å¯¹</td><td style="text-align:center;">ä»…å­˜å‚¨å¯¹è±¡</td></tr><tr><td style="text-align:center;">è°ƒç”¨ <code>put()</code>å‘ map ä¸­æ·»åŠ å…ƒç´ </td><td style="text-align:center;">è°ƒç”¨ <code>add()</code>æ–¹æ³•å‘ <code>Set</code> ä¸­æ·»åŠ å…ƒç´ </td></tr><tr><td style="text-align:center;"><code>HashMap</code> ä½¿ç”¨é”®ï¼ˆKeyï¼‰è®¡ç®— <code>hashcode</code></td><td style="text-align:center;"><code>HashSet</code> ä½¿ç”¨æˆå‘˜å¯¹è±¡æ¥è®¡ç®— <code>hashcode</code> å€¼ï¼Œå¯¹äºä¸¤ä¸ªå¯¹è±¡æ¥è¯´ <code>hashcode</code> å¯èƒ½ç›¸åŒï¼Œæ‰€ä»¥<code>equals()</code>æ–¹æ³•ç”¨æ¥åˆ¤æ–­å¯¹è±¡çš„ç›¸ç­‰æ€§</td></tr></tbody></table><h2 id="hashmap-å’Œ-treemap-åŒºåˆ«" tabindex="-1"><a class="header-anchor" href="#hashmap-å’Œ-treemap-åŒºåˆ«"><span>HashMap å’Œ TreeMap åŒºåˆ«</span></a></h2><p><code>TreeMap</code> å’Œ<code>HashMap</code> éƒ½ç»§æ‰¿è‡ª<code>AbstractMap</code> ï¼Œä½†æ˜¯éœ€è¦æ³¨æ„çš„æ˜¯<code>TreeMap</code>å®ƒè¿˜å®ç°äº†<code>NavigableMap</code>æ¥å£å’Œ<code>SortedMap</code> æ¥å£ã€‚</p><p>å®ç° <code>NavigableMap</code> æ¥å£è®© <code>TreeMap</code> æœ‰äº†å¯¹é›†åˆå†…å…ƒç´ çš„æœç´¢çš„èƒ½åŠ›ã€‚</p><p>å®ç°<code>SortedMap</code>æ¥å£è®© <code>TreeMap</code> æœ‰äº†å¯¹é›†åˆä¸­çš„å…ƒç´ æ ¹æ®é”®æ’åºçš„èƒ½åŠ›ã€‚é»˜è®¤æ˜¯æŒ‰ key çš„å‡åºæ’åºï¼Œä¸è¿‡æˆ‘ä»¬ä¹Ÿå¯ä»¥æŒ‡å®šæ’åºçš„æ¯”è¾ƒå™¨ã€‚ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="--shiki-light:#393a34;--shiki-dark:#e1e4e8;--shiki-light-bg:#ffffff;--shiki-dark-bg:#24292e;"><pre class="shiki shiki-themes vitesse-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#6A737D;">/**</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#6A737D;"> * </span><span style="--shiki-light:#1E754F;--shiki-dark:#F97583;">@author</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#6A737D;"> shuang.kou</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#6A737D;"> * @createTime 2020å¹´06æœˆ15æ—¥ 17:02:00</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#6A737D;"> */</span></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#F97583;">public</span><span style="--shiki-light:#AB5959;--shiki-dark:#F97583;"> class</span><span style="--shiki-light:#2E8F82;--shiki-dark:#B392F0;"> Person</span><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#F97583;">    private</span><span style="--shiki-light:#393A34;--shiki-dark:#E1E4E8;"> Integer</span><span style="--shiki-light:#B07D48;--shiki-dark:#E1E4E8;"> age</span><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#F97583;">    public</span><span style="--shiki-light:#59873A;--shiki-dark:#B392F0;"> Person</span><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#393A34;--shiki-dark:#E1E4E8;">Integer </span><span style="--shiki-light:#B07D48;--shiki-dark:#FFAB70;">age</span><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;">)</span><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#A65E2B;--shiki-dark:#79B8FF;">        this</span><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#B07D48;--shiki-dark:#E1E4E8;">age</span><span style="--shiki-light:#999999;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#393A34;--shiki-dark:#E1E4E8;"> age</span><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#F97583;">    public</span><span style="--shiki-light:#393A34;--shiki-dark:#E1E4E8;"> Integer </span><span style="--shiki-light:#59873A;--shiki-dark:#B392F0;">getAge</span><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;">()</span><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#F97583;">        return</span><span style="--shiki-light:#393A34;--shiki-dark:#E1E4E8;"> age</span><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#F97583;">    public</span><span style="--shiki-light:#AB5959;--shiki-dark:#F97583;"> static</span><span style="--shiki-light:#AB5959;--shiki-dark:#F97583;"> void</span><span style="--shiki-light:#59873A;--shiki-dark:#B392F0;"> main</span><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#AB5959;--shiki-dark:#F97583;">String</span><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;">[]</span><span style="--shiki-light:#B07D48;--shiki-dark:#FFAB70;"> args</span><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;">)</span><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#E1E4E8;">        TreeMap</span><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#AB5959;--shiki-dark:#F97583;">Person</span><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#AB5959;--shiki-dark:#F97583;"> String</span><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;">&gt;</span><span style="--shiki-light:#B07D48;--shiki-dark:#E1E4E8;"> treeMap</span><span style="--shiki-light:#999999;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#1E754F;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#393A34;--shiki-dark:#E1E4E8;"> TreeMap</span><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;">&lt;&gt;(</span><span style="--shiki-light:#1E754F;--shiki-dark:#F97583;">new</span><span style="--shiki-light:#393A34;--shiki-dark:#E1E4E8;"> Comparator</span><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#AB5959;--shiki-dark:#F97583;">Person</span><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;">&gt;()</span><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;">            @</span><span style="--shiki-light:#AB5959;--shiki-dark:#F97583;">Override</span></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#F97583;">            public</span><span style="--shiki-light:#AB5959;--shiki-dark:#F97583;"> int</span><span style="--shiki-light:#59873A;--shiki-dark:#B392F0;"> compare</span><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#393A34;--shiki-dark:#E1E4E8;">Person </span><span style="--shiki-light:#B07D48;--shiki-dark:#FFAB70;">person1</span><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#393A34;--shiki-dark:#E1E4E8;"> Person </span><span style="--shiki-light:#B07D48;--shiki-dark:#FFAB70;">person2</span><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;">)</span><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#F97583;">                int</span><span style="--shiki-light:#B07D48;--shiki-dark:#E1E4E8;"> num</span><span style="--shiki-light:#999999;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#B07D48;--shiki-dark:#E1E4E8;"> person1</span><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#59873A;--shiki-dark:#B392F0;">getAge</span><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;">()</span><span style="--shiki-light:#AB5959;--shiki-dark:#F97583;"> -</span><span style="--shiki-light:#B07D48;--shiki-dark:#E1E4E8;"> person2</span><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#59873A;--shiki-dark:#B392F0;">getAge</span><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#F97583;">                return</span><span style="--shiki-light:#B07D48;--shiki-dark:#E1E4E8;"> Integer</span><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#59873A;--shiki-dark:#B392F0;">compare</span><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#393A34;--shiki-dark:#E1E4E8;">num</span><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#2F798A;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;">            }</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;">        });</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#E1E4E8;">        treeMap</span><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#59873A;--shiki-dark:#B392F0;">put</span><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#1E754F;--shiki-dark:#F97583;">new</span><span style="--shiki-light:#59873A;--shiki-dark:#B392F0;"> Person</span><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#2F798A;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;">),</span><span style="--shiki-light:#B5695977;--shiki-dark:#9ECBFF;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#9ECBFF;">person1</span><span style="--shiki-light:#B5695977;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#E1E4E8;">        treeMap</span><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#59873A;--shiki-dark:#B392F0;">put</span><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#1E754F;--shiki-dark:#F97583;">new</span><span style="--shiki-light:#59873A;--shiki-dark:#B392F0;"> Person</span><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#2F798A;--shiki-dark:#79B8FF;">18</span><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;">),</span><span style="--shiki-light:#B5695977;--shiki-dark:#9ECBFF;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#9ECBFF;">person2</span><span style="--shiki-light:#B5695977;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#E1E4E8;">        treeMap</span><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#59873A;--shiki-dark:#B392F0;">put</span><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#1E754F;--shiki-dark:#F97583;">new</span><span style="--shiki-light:#59873A;--shiki-dark:#B392F0;"> Person</span><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#2F798A;--shiki-dark:#79B8FF;">35</span><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;">),</span><span style="--shiki-light:#B5695977;--shiki-dark:#9ECBFF;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#9ECBFF;">person3</span><span style="--shiki-light:#B5695977;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#E1E4E8;">        treeMap</span><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#59873A;--shiki-dark:#B392F0;">put</span><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#1E754F;--shiki-dark:#F97583;">new</span><span style="--shiki-light:#59873A;--shiki-dark:#B392F0;"> Person</span><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#2F798A;--shiki-dark:#79B8FF;">16</span><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;">),</span><span style="--shiki-light:#B5695977;--shiki-dark:#9ECBFF;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#9ECBFF;">person4</span><span style="--shiki-light:#B5695977;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#E1E4E8;">        treeMap</span><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#59873A;--shiki-dark:#B392F0;">entrySet</span><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;">().</span><span style="--shiki-light:#59873A;--shiki-dark:#B392F0;">stream</span><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;">().</span><span style="--shiki-light:#59873A;--shiki-dark:#B392F0;">forEach</span><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#393A34;--shiki-dark:#E1E4E8;">personStringEntry </span><span style="--shiki-light:#999999;--shiki-dark:#F97583;">-&gt;</span><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#E1E4E8;">            System</span><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#B07D48;--shiki-dark:#E1E4E8;">out</span><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#59873A;--shiki-dark:#B392F0;">println</span><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#B07D48;--shiki-dark:#E1E4E8;">personStringEntry</span><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#59873A;--shiki-dark:#B392F0;">getValue</span><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;">());</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;">        });</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¾“å‡º:</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#393a34;--shiki-dark:#e1e4e8;--shiki-light-bg:#ffffff;--shiki-dark-bg:#24292e;"><pre class="shiki shiki-themes vitesse-light github-dark vp-code"><code><span class="line"><span>person1</span></span>
<span class="line"><span>person4</span></span>
<span class="line"><span>person2</span></span>
<span class="line"><span>person3</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¯ä»¥çœ‹å‡ºï¼Œ<code>TreeMap</code> ä¸­çš„å…ƒç´ å·²ç»æ˜¯æŒ‰ç…§ <code>Person</code> çš„ age å­—æ®µçš„å‡åºæ¥æ’åˆ—äº†ã€‚</p><p>ä¸Šé¢ï¼Œæˆ‘ä»¬æ˜¯é€šè¿‡ä¼ å…¥åŒ¿åå†…éƒ¨ç±»çš„æ–¹å¼å®ç°çš„ï¼Œä½ å¯ä»¥å°†ä»£ç æ›¿æ¢æˆ Lambda è¡¨è¾¾å¼å®ç°çš„æ–¹å¼ï¼š</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="--shiki-light:#393a34;--shiki-dark:#e1e4e8;--shiki-light-bg:#ffffff;--shiki-dark-bg:#24292e;"><pre class="shiki shiki-themes vitesse-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#E1E4E8;">TreeMap</span><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#AB5959;--shiki-dark:#F97583;">Person</span><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#AB5959;--shiki-dark:#F97583;"> String</span><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;">&gt;</span><span style="--shiki-light:#B07D48;--shiki-dark:#E1E4E8;"> treeMap</span><span style="--shiki-light:#999999;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#1E754F;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#393A34;--shiki-dark:#E1E4E8;"> TreeMap</span><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;">&lt;&gt;((</span><span style="--shiki-light:#393A34;--shiki-dark:#E1E4E8;">person1</span><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#393A34;--shiki-dark:#E1E4E8;"> person2</span><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;">)</span><span style="--shiki-light:#999999;--shiki-dark:#F97583;"> -&gt;</span><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#F97583;">  int</span><span style="--shiki-light:#B07D48;--shiki-dark:#E1E4E8;"> num</span><span style="--shiki-light:#999999;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#B07D48;--shiki-dark:#E1E4E8;"> person1</span><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#59873A;--shiki-dark:#B392F0;">getAge</span><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;">()</span><span style="--shiki-light:#AB5959;--shiki-dark:#F97583;"> -</span><span style="--shiki-light:#B07D48;--shiki-dark:#E1E4E8;"> person2</span><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#59873A;--shiki-dark:#B392F0;">getAge</span><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#F97583;">  return</span><span style="--shiki-light:#B07D48;--shiki-dark:#E1E4E8;"> Integer</span><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#59873A;--shiki-dark:#B392F0;">compare</span><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#393A34;--shiki-dark:#E1E4E8;">num</span><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#2F798A;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>ç»¼ä¸Šï¼Œç›¸æ¯”äº<code>HashMap</code>æ¥è¯´ <code>TreeMap</code> ä¸»è¦å¤šäº†å¯¹é›†åˆä¸­çš„å…ƒç´ æ ¹æ®é”®æ’åºçš„èƒ½åŠ›ä»¥åŠå¯¹é›†åˆå†…å…ƒç´ çš„æœç´¢çš„èƒ½åŠ›ã€‚</strong></p><h2 id="hashset-å¦‚ä½•æ£€æŸ¥é‡å¤" tabindex="-1"><a class="header-anchor" href="#hashset-å¦‚ä½•æ£€æŸ¥é‡å¤"><span>HashSet å¦‚ä½•æ£€æŸ¥é‡å¤</span></a></h2><p>ä»¥ä¸‹å†…å®¹æ‘˜è‡ªæˆ‘çš„ Java å¯è’™ä¹¦ã€ŠHead first javaã€‹ç¬¬äºŒç‰ˆï¼š</p><p>å½“ä½ æŠŠå¯¹è±¡åŠ å…¥<code>HashSet</code>æ—¶ï¼Œ<code>HashSet</code> ä¼šå…ˆè®¡ç®—å¯¹è±¡çš„<code>hashcode</code>å€¼æ¥åˆ¤æ–­å¯¹è±¡åŠ å…¥çš„ä½ç½®ï¼ŒåŒæ—¶ä¹Ÿä¼šä¸å…¶ä»–åŠ å…¥çš„å¯¹è±¡çš„ <code>hashcode</code> å€¼ä½œæ¯”è¾ƒï¼Œå¦‚æœæ²¡æœ‰ç›¸ç¬¦çš„ <code>hashcode</code>ï¼Œ<code>HashSet</code> ä¼šå‡è®¾å¯¹è±¡æ²¡æœ‰é‡å¤å‡ºç°ã€‚ä½†æ˜¯å¦‚æœå‘ç°æœ‰ç›¸åŒ <code>hashcode</code> å€¼çš„å¯¹è±¡ï¼Œè¿™æ—¶ä¼šè°ƒç”¨<code>equals()</code>æ–¹æ³•æ¥æ£€æŸ¥ <code>hashcode</code> ç›¸ç­‰çš„å¯¹è±¡æ˜¯å¦çœŸçš„ç›¸åŒã€‚å¦‚æœä¸¤è€…ç›¸åŒï¼Œ<code>HashSet</code> å°±ä¸ä¼šè®©åŠ å…¥æ“ä½œæˆåŠŸã€‚</p><p>åœ¨openjdk8ä¸­ï¼Œ<code>HashSet</code>çš„<code>add()</code>æ–¹æ³•åªæ˜¯ç®€å•çš„è°ƒç”¨äº†<code>HashMap</code>çš„<code>put()</code>æ–¹æ³•ï¼Œå¹¶ä¸”åˆ¤æ–­äº†ä¸€ä¸‹è¿”å›å€¼ä»¥ç¡®ä¿æ˜¯å¦æœ‰é‡å¤å…ƒç´ ã€‚ç›´æ¥çœ‹ä¸€ä¸‹<code>HashSet</code>ä¸­çš„æºç ï¼š</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="--shiki-light:#393a34;--shiki-dark:#e1e4e8;--shiki-light-bg:#ffffff;--shiki-dark-bg:#24292e;"><pre class="shiki shiki-themes vitesse-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#6A737D;">// Returns: true if this set did not already contain the specified element</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#6A737D;">// è¿”å›å€¼ï¼šå½“setä¸­æ²¡æœ‰åŒ…å«addçš„å…ƒç´ æ—¶è¿”å›çœŸ</span></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#F97583;">public</span><span style="--shiki-light:#AB5959;--shiki-dark:#F97583;"> boolean</span><span style="--shiki-light:#59873A;--shiki-dark:#B392F0;"> add</span><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#393A34;--shiki-dark:#E1E4E8;">E e</span><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;">)</span><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#F97583;">        return</span><span style="--shiki-light:#B07D48;--shiki-dark:#E1E4E8;"> map</span><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#59873A;--shiki-dark:#B392F0;">put</span><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#393A34;--shiki-dark:#E1E4E8;">e</span><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#393A34;--shiki-dark:#E1E4E8;"> PRESENT</span><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;">)</span><span style="--shiki-light:#AB5959;--shiki-dark:#F97583;">==</span><span style="--shiki-light:#1E754F;--shiki-dark:#79B8FF;">null</span><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è€Œåœ¨<code>HashMap</code>çš„<code>putVal()</code>æ–¹æ³•ä¸­ä¹Ÿèƒ½çœ‹åˆ°å¦‚ä¸‹è¯´æ˜ï¼š</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="--shiki-light:#393a34;--shiki-dark:#e1e4e8;--shiki-light-bg:#ffffff;--shiki-dark-bg:#24292e;"><pre class="shiki shiki-themes vitesse-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#6A737D;">// Returns : previous value, or null if none</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#6A737D;">// è¿”å›å€¼ï¼šå¦‚æœæ’å…¥ä½ç½®æ²¡æœ‰å…ƒç´ è¿”å›nullï¼Œå¦åˆ™è¿”å›ä¸Šä¸€ä¸ªå…ƒç´ </span></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#F97583;">final</span><span style="--shiki-light:#393A34;--shiki-dark:#E1E4E8;"> V </span><span style="--shiki-light:#59873A;--shiki-dark:#B392F0;">putVal</span><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#AB5959;--shiki-dark:#F97583;">int</span><span style="--shiki-light:#393A34;--shiki-dark:#E1E4E8;"> hash</span><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#393A34;--shiki-dark:#E1E4E8;"> K key</span><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#393A34;--shiki-dark:#E1E4E8;"> V value</span><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#AB5959;--shiki-dark:#F97583;"> boolean</span><span style="--shiki-light:#393A34;--shiki-dark:#E1E4E8;"> onlyIfAbsent</span><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#F97583;">                   boolean</span><span style="--shiki-light:#393A34;--shiki-dark:#E1E4E8;"> evict</span><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;">)</span><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;">...</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨openjdk8ä¸­ï¼Œå®é™…ä¸Šæ— è®º<code>HashSet</code>ä¸­æ˜¯å¦å·²ç»å­˜åœ¨äº†æŸå…ƒç´ ï¼Œ<code>HashSet</code>éƒ½ä¼šç›´æ¥æ’å…¥ï¼Œåªæ˜¯ä¼šåœ¨<code>add()</code>æ–¹æ³•çš„è¿”å›å€¼å¤„å‘Šè¯‰æˆ‘ä»¬æ’å…¥å‰æ˜¯å¦å­˜åœ¨ç›¸åŒå…ƒç´ ã€‚</p><p><strong><code>hashCode()</code>ä¸ <code>equals()</code> çš„ç›¸å…³è§„å®šï¼š</strong></p><ol><li>å¦‚æœä¸¤ä¸ªå¯¹è±¡ç›¸ç­‰ï¼Œåˆ™ <code>hashcode</code> ä¸€å®šä¹Ÿæ˜¯ç›¸åŒçš„</li><li>ä¸¤ä¸ªå¯¹è±¡ç›¸ç­‰,å¯¹ä¸¤ä¸ª <code>equals()</code> æ–¹æ³•è¿”å› true</li><li>ä¸¤ä¸ªå¯¹è±¡æœ‰ç›¸åŒçš„ <code>hashcode</code> å€¼ï¼Œå®ƒä»¬ä¹Ÿä¸ä¸€å®šæ˜¯ç›¸ç­‰çš„</li><li>ç»¼ä¸Šï¼Œ<code>equals()</code> æ–¹æ³•è¢«è¦†ç›–è¿‡ï¼Œåˆ™ <code>hashCode()</code> æ–¹æ³•ä¹Ÿå¿…é¡»è¢«è¦†ç›–</li><li><code>hashCode()</code>çš„é»˜è®¤è¡Œä¸ºæ˜¯å¯¹å †ä¸Šçš„å¯¹è±¡äº§ç”Ÿç‹¬ç‰¹å€¼ã€‚å¦‚æœæ²¡æœ‰é‡å†™ <code>hashCode()</code>ï¼Œåˆ™è¯¥ class çš„ä¸¤ä¸ªå¯¹è±¡æ— è®ºå¦‚ä½•éƒ½ä¸ä¼šç›¸ç­‰ï¼ˆå³ä½¿è¿™ä¸¤ä¸ªå¯¹è±¡æŒ‡å‘ç›¸åŒçš„æ•°æ®ï¼‰ã€‚</li></ol><p><strong>==ä¸ equals çš„åŒºåˆ«</strong></p><p>å¯¹äºåŸºæœ¬ç±»å‹æ¥è¯´ï¼Œ== æ¯”è¾ƒçš„æ˜¯å€¼æ˜¯å¦ç›¸ç­‰ï¼›</p><p>å¯¹äºå¼•ç”¨ç±»å‹æ¥è¯´ï¼Œ== æ¯”è¾ƒçš„æ˜¯ä¸¤ä¸ªå¼•ç”¨æ˜¯å¦æŒ‡å‘åŒä¸€ä¸ªå¯¹è±¡åœ°å€ï¼ˆä¸¤è€…åœ¨å†…å­˜ä¸­å­˜æ”¾çš„åœ°å€ï¼ˆå †å†…å­˜åœ°å€ï¼‰æ˜¯å¦æŒ‡å‘åŒä¸€ä¸ªåœ°æ–¹ï¼‰ï¼›</p><p>å¯¹äºå¼•ç”¨ç±»å‹ï¼ˆåŒ…æ‹¬åŒ…è£…ç±»å‹ï¼‰æ¥è¯´ï¼Œequals å¦‚æœæ²¡æœ‰è¢«é‡å†™ï¼Œå¯¹æ¯”å®ƒä»¬çš„åœ°å€æ˜¯å¦ç›¸ç­‰ï¼›å¦‚æœ equals()æ–¹æ³•è¢«é‡å†™ï¼ˆä¾‹å¦‚ Stringï¼‰ï¼Œåˆ™æ¯”è¾ƒçš„æ˜¯åœ°å€é‡Œçš„å†…å®¹ã€‚</p><h2 id="hashmap-çš„åº•å±‚å®ç°" tabindex="-1"><a class="header-anchor" href="#hashmap-çš„åº•å±‚å®ç°"><span>HashMap çš„åº•å±‚å®ç°</span></a></h2><h3 id="jdk1-8-ä¹‹å‰" tabindex="-1"><a class="header-anchor" href="#jdk1-8-ä¹‹å‰"><span>JDK1.8 ä¹‹å‰</span></a></h3><p>JDK1.8 ä¹‹å‰ <code>HashMap</code> åº•å±‚æ˜¯ <strong>æ•°ç»„å’Œé“¾è¡¨</strong> ç»“åˆåœ¨ä¸€èµ·ä½¿ç”¨ä¹Ÿå°±æ˜¯ <strong>é“¾è¡¨æ•£åˆ—</strong>ã€‚<strong>HashMap é€šè¿‡ key çš„ hashCode ç»è¿‡æ‰°åŠ¨å‡½æ•°å¤„ç†è¿‡åå¾—åˆ° hash å€¼ï¼Œç„¶åé€šè¿‡ (n - 1) &amp; hash åˆ¤æ–­å½“å‰å…ƒç´ å­˜æ”¾çš„ä½ç½®ï¼ˆè¿™é‡Œçš„ n æŒ‡çš„æ˜¯æ•°ç»„çš„é•¿åº¦ï¼‰ï¼Œå¦‚æœå½“å‰ä½ç½®å­˜åœ¨å…ƒç´ çš„è¯ï¼Œå°±åˆ¤æ–­è¯¥å…ƒç´ ä¸è¦å­˜å…¥çš„å…ƒç´ çš„ hash å€¼ä»¥åŠ key æ˜¯å¦ç›¸åŒï¼Œå¦‚æœç›¸åŒçš„è¯ï¼Œç›´æ¥è¦†ç›–ï¼Œä¸ç›¸åŒå°±é€šè¿‡æ‹‰é“¾æ³•è§£å†³å†²çªã€‚</strong></p><p><strong>æ‰€è°“æ‰°åŠ¨å‡½æ•°æŒ‡çš„å°±æ˜¯ HashMap çš„ hash æ–¹æ³•ã€‚ä½¿ç”¨ hash æ–¹æ³•ä¹Ÿå°±æ˜¯æ‰°åŠ¨å‡½æ•°æ˜¯ä¸ºäº†é˜²æ­¢ä¸€äº›å®ç°æ¯”è¾ƒå·®çš„ hashCode() æ–¹æ³• æ¢å¥è¯è¯´ä½¿ç”¨æ‰°åŠ¨å‡½æ•°ä¹‹åå¯ä»¥å‡å°‘ç¢°æ’ã€‚</strong></p><p><strong>JDK 1.8 HashMap çš„ hash æ–¹æ³•æºç :</strong></p><p>JDK 1.8 çš„ hash æ–¹æ³• ç›¸æ¯”äº JDK 1.7 hash æ–¹æ³•æ›´åŠ ç®€åŒ–ï¼Œä½†æ˜¯åŸç†ä¸å˜ã€‚</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="--shiki-light:#393a34;--shiki-dark:#e1e4e8;--shiki-light-bg:#ffffff;--shiki-dark-bg:#24292e;"><pre class="shiki shiki-themes vitesse-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#F97583;">    static</span><span style="--shiki-light:#AB5959;--shiki-dark:#F97583;"> final</span><span style="--shiki-light:#AB5959;--shiki-dark:#F97583;"> int</span><span style="--shiki-light:#59873A;--shiki-dark:#B392F0;"> hash</span><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#393A34;--shiki-dark:#E1E4E8;">Object key</span><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;">)</span><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#F97583;">      int</span><span style="--shiki-light:#B07D48;--shiki-dark:#E1E4E8;"> h</span><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#6A737D;">      // key.hashCode()ï¼šè¿”å›æ•£åˆ—å€¼ä¹Ÿå°±æ˜¯hashcode</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#6A737D;">      // ^ ï¼šæŒ‰ä½å¼‚æˆ–</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#6A737D;">      // &gt;&gt;&gt;:æ— ç¬¦å·å³ç§»ï¼Œå¿½ç•¥ç¬¦å·ä½ï¼Œç©ºä½éƒ½ä»¥0è¡¥é½</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#F97583;">      return</span><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#393A34;--shiki-dark:#E1E4E8;">key </span><span style="--shiki-light:#AB5959;--shiki-dark:#F97583;">==</span><span style="--shiki-light:#1E754F;--shiki-dark:#79B8FF;"> null</span><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;">)</span><span style="--shiki-light:#1E754F;--shiki-dark:#F97583;"> ?</span><span style="--shiki-light:#2F798A;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#1E754F;--shiki-dark:#F97583;"> :</span><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#393A34;--shiki-dark:#E1E4E8;">h </span><span style="--shiki-light:#999999;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#B07D48;--shiki-dark:#E1E4E8;"> key</span><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#59873A;--shiki-dark:#B392F0;">hashCode</span><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;">())</span><span style="--shiki-light:#AB5959;--shiki-dark:#F97583;"> ^</span><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#393A34;--shiki-dark:#E1E4E8;">h </span><span style="--shiki-light:#AB5959;--shiki-dark:#F97583;">&gt;&gt;&gt;</span><span style="--shiki-light:#2F798A;--shiki-dark:#79B8FF;"> 16</span><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;">  }</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¯¹æ¯”ä¸€ä¸‹ JDK1.7 çš„ HashMap çš„ hash æ–¹æ³•æºç .</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="--shiki-light:#393a34;--shiki-dark:#e1e4e8;--shiki-light-bg:#ffffff;--shiki-dark-bg:#24292e;"><pre class="shiki shiki-themes vitesse-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#F97583;">static</span><span style="--shiki-light:#AB5959;--shiki-dark:#F97583;"> int</span><span style="--shiki-light:#59873A;--shiki-dark:#B392F0;"> hash</span><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#AB5959;--shiki-dark:#F97583;">int</span><span style="--shiki-light:#393A34;--shiki-dark:#E1E4E8;"> h</span><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;">)</span><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#6A737D;">    // This function ensures that hashCodes that differ only by</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#6A737D;">    // constant multiples at each bit position have a bounded</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#6A737D;">    // number of collisions (approximately 8 at default load factor).</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#E1E4E8;">    h </span><span style="--shiki-light:#AB5959;--shiki-dark:#F97583;">^</span><span style="--shiki-light:#999999;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#393A34;--shiki-dark:#E1E4E8;">h </span><span style="--shiki-light:#AB5959;--shiki-dark:#F97583;">&gt;&gt;&gt;</span><span style="--shiki-light:#2F798A;--shiki-dark:#79B8FF;"> 20</span><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;">)</span><span style="--shiki-light:#AB5959;--shiki-dark:#F97583;"> ^</span><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#393A34;--shiki-dark:#E1E4E8;">h </span><span style="--shiki-light:#AB5959;--shiki-dark:#F97583;">&gt;&gt;&gt;</span><span style="--shiki-light:#2F798A;--shiki-dark:#79B8FF;"> 12</span><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#393A34;--shiki-dark:#E1E4E8;"> h </span><span style="--shiki-light:#AB5959;--shiki-dark:#F97583;">^</span><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#393A34;--shiki-dark:#E1E4E8;">h </span><span style="--shiki-light:#AB5959;--shiki-dark:#F97583;">&gt;&gt;&gt;</span><span style="--shiki-light:#2F798A;--shiki-dark:#79B8FF;"> 7</span><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;">)</span><span style="--shiki-light:#AB5959;--shiki-dark:#F97583;"> ^</span><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#393A34;--shiki-dark:#E1E4E8;">h </span><span style="--shiki-light:#AB5959;--shiki-dark:#F97583;">&gt;&gt;&gt;</span><span style="--shiki-light:#2F798A;--shiki-dark:#79B8FF;"> 4</span><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ç›¸æ¯”äº JDK1.8 çš„ hash æ–¹æ³• ï¼ŒJDK 1.7 çš„ hash æ–¹æ³•çš„æ€§èƒ½ä¼šç¨å·®ä¸€ç‚¹ç‚¹ï¼Œå› ä¸ºæ¯•ç«Ÿæ‰°åŠ¨äº† 4 æ¬¡ã€‚</p><p>æ‰€è°“ <strong>â€œæ‹‰é“¾æ³•â€</strong> å°±æ˜¯ï¼šå°†é“¾è¡¨å’Œæ•°ç»„ç›¸ç»“åˆã€‚ä¹Ÿå°±æ˜¯è¯´åˆ›å»ºä¸€ä¸ªé“¾è¡¨æ•°ç»„ï¼Œæ•°ç»„ä¸­æ¯ä¸€æ ¼å°±æ˜¯ä¸€ä¸ªé“¾è¡¨ã€‚è‹¥é‡åˆ°å“ˆå¸Œå†²çªï¼Œåˆ™å°†å†²çªçš„å€¼åŠ åˆ°é“¾è¡¨ä¸­å³å¯ã€‚</p><p>[æ­¤å¤„éœ€è¦è¡¥å……å›¾ç‰‡ï¼šjdk1.8ä¹‹å‰çš„å†…éƒ¨ç»“æ„-HashMap.png]</p><h3 id="jdk1-8-ä¹‹å" tabindex="-1"><a class="header-anchor" href="#jdk1-8-ä¹‹å"><span>JDK1.8 ä¹‹å</span></a></h3><p>ç›¸æ¯”äºä¹‹å‰çš„ç‰ˆæœ¬ï¼Œ JDK1.8 ä¹‹ååœ¨è§£å†³å“ˆå¸Œå†²çªæ—¶æœ‰äº†è¾ƒå¤§çš„å˜åŒ–ï¼Œå½“é“¾è¡¨é•¿åº¦å¤§äºé˜ˆå€¼ï¼ˆé»˜è®¤ä¸º 8ï¼‰ï¼ˆå°†é“¾è¡¨è½¬æ¢æˆçº¢é»‘æ ‘å‰ä¼šåˆ¤æ–­ï¼Œå¦‚æœå½“å‰æ•°ç»„çš„é•¿åº¦å°äº 64ï¼Œé‚£ä¹ˆä¼šé€‰æ‹©å…ˆè¿›è¡Œæ•°ç»„æ‰©å®¹ï¼Œè€Œä¸æ˜¯è½¬æ¢ä¸ºçº¢é»‘æ ‘ï¼‰æ—¶ï¼Œå°†é“¾è¡¨è½¬åŒ–ä¸ºçº¢é»‘æ ‘ï¼Œä»¥å‡å°‘æœç´¢æ—¶é—´ã€‚</p><blockquote><p>TreeMapã€TreeSet ä»¥åŠ JDK1.8 ä¹‹åçš„ HashMap åº•å±‚éƒ½ç”¨åˆ°äº†çº¢é»‘æ ‘ã€‚çº¢é»‘æ ‘å°±æ˜¯ä¸ºäº†è§£å†³äºŒå‰æŸ¥æ‰¾æ ‘çš„ç¼ºé™·ï¼Œå› ä¸ºäºŒå‰æŸ¥æ‰¾æ ‘åœ¨æŸäº›æƒ…å†µä¸‹ä¼šé€€åŒ–æˆä¸€ä¸ªçº¿æ€§ç»“æ„ã€‚</p></blockquote><h2 id="hashmap-çš„é•¿åº¦ä¸ºä»€ä¹ˆæ˜¯-2-çš„å¹‚æ¬¡æ–¹" tabindex="-1"><a class="header-anchor" href="#hashmap-çš„é•¿åº¦ä¸ºä»€ä¹ˆæ˜¯-2-çš„å¹‚æ¬¡æ–¹"><span>HashMap çš„é•¿åº¦ä¸ºä»€ä¹ˆæ˜¯ 2 çš„å¹‚æ¬¡æ–¹</span></a></h2><p>ä¸ºäº†èƒ½è®© HashMap å­˜å–é«˜æ•ˆï¼Œå°½é‡è¾ƒå°‘ç¢°æ’ï¼Œä¹Ÿå°±æ˜¯è¦å°½é‡æŠŠæ•°æ®åˆ†é…å‡åŒ€ã€‚æˆ‘ä»¬ä¸Šé¢ä¹Ÿè®²åˆ°äº†è¿‡äº†ï¼ŒHash å€¼çš„èŒƒå›´å€¼-2147483648 åˆ° 2147483647ï¼Œå‰ååŠ èµ·æ¥å¤§æ¦‚ 40 äº¿çš„æ˜ å°„ç©ºé—´ï¼Œåªè¦å“ˆå¸Œå‡½æ•°æ˜ å°„å¾—æ¯”è¾ƒå‡åŒ€æ¾æ•£ï¼Œä¸€èˆ¬åº”ç”¨æ˜¯å¾ˆéš¾å‡ºç°ç¢°æ’çš„ã€‚ä½†é—®é¢˜æ˜¯ä¸€ä¸ª 40 äº¿é•¿åº¦çš„æ•°ç»„ï¼Œå†…å­˜æ˜¯æ”¾ä¸ä¸‹çš„ã€‚æ‰€ä»¥è¿™ä¸ªæ•£åˆ—å€¼æ˜¯ä¸èƒ½ç›´æ¥æ‹¿æ¥ç”¨çš„ã€‚ç”¨ä¹‹å‰è¿˜è¦å…ˆåšå¯¹æ•°ç»„çš„é•¿åº¦å–æ¨¡è¿ç®—ï¼Œå¾—åˆ°çš„ä½™æ•°æ‰èƒ½ç”¨æ¥è¦å­˜æ”¾çš„ä½ç½®ä¹Ÿå°±æ˜¯å¯¹åº”çš„æ•°ç»„ä¸‹æ ‡ã€‚è¿™ä¸ªæ•°ç»„ä¸‹æ ‡çš„è®¡ç®—æ–¹æ³•æ˜¯â€œ <code>(n - 1) &amp; hash</code>â€ã€‚ï¼ˆn ä»£è¡¨æ•°ç»„é•¿åº¦ï¼‰ã€‚è¿™ä¹Ÿå°±è§£é‡Šäº† HashMap çš„é•¿åº¦ä¸ºä»€ä¹ˆæ˜¯ 2 çš„å¹‚æ¬¡æ–¹ã€‚</p><p><strong>è¿™ä¸ªç®—æ³•åº”è¯¥å¦‚ä½•è®¾è®¡å‘¢ï¼Ÿ</strong></p><p>æˆ‘ä»¬é¦–å…ˆå¯èƒ½ä¼šæƒ³åˆ°é‡‡ç”¨%å–ä½™çš„æ“ä½œæ¥å®ç°ã€‚ä½†æ˜¯ï¼Œé‡ç‚¹æ¥äº†ï¼š<strong>â€œå–ä½™(%)æ“ä½œä¸­å¦‚æœé™¤æ•°æ˜¯ 2 çš„å¹‚æ¬¡åˆ™ç­‰ä»·äºä¸å…¶é™¤æ•°å‡ä¸€çš„ä¸(&amp;)æ“ä½œï¼ˆä¹Ÿå°±æ˜¯è¯´ hash%length==hash&amp;(length-1)çš„å‰ææ˜¯ length æ˜¯ 2 çš„ n æ¬¡æ–¹ï¼›ï¼‰ã€‚â€</strong> å¹¶ä¸” <strong>é‡‡ç”¨äºŒè¿›åˆ¶ä½æ“ä½œ &amp;ï¼Œç›¸å¯¹äº%èƒ½å¤Ÿæé«˜è¿ç®—æ•ˆç‡ï¼Œè¿™å°±è§£é‡Šäº† HashMap çš„é•¿åº¦ä¸ºä»€ä¹ˆæ˜¯ 2 çš„å¹‚æ¬¡æ–¹ã€‚</strong></p><h2 id="hashmap-å¤šçº¿ç¨‹æ“ä½œå¯¼è‡´æ­»å¾ªç¯é—®é¢˜" tabindex="-1"><a class="header-anchor" href="#hashmap-å¤šçº¿ç¨‹æ“ä½œå¯¼è‡´æ­»å¾ªç¯é—®é¢˜"><span>HashMap å¤šçº¿ç¨‹æ“ä½œå¯¼è‡´æ­»å¾ªç¯é—®é¢˜</span></a></h2><p>ä¸»è¦åŸå› åœ¨äºå¹¶å‘ä¸‹çš„ Rehash ä¼šé€ æˆå…ƒç´ ä¹‹é—´ä¼šå½¢æˆä¸€ä¸ªå¾ªç¯é“¾è¡¨ã€‚ä¸è¿‡ï¼Œjdk 1.8 åè§£å†³äº†è¿™ä¸ªé—®é¢˜ï¼Œä½†æ˜¯è¿˜æ˜¯ä¸å»ºè®®åœ¨å¤šçº¿ç¨‹ä¸‹ä½¿ç”¨ HashMap,å› ä¸ºå¤šçº¿ç¨‹ä¸‹ä½¿ç”¨ HashMap è¿˜æ˜¯ä¼šå­˜åœ¨å…¶ä»–é—®é¢˜æ¯”å¦‚æ•°æ®ä¸¢å¤±ã€‚å¹¶å‘ç¯å¢ƒä¸‹æ¨èä½¿ç”¨ ConcurrentHashMap ã€‚</p><p>è¯¦æƒ…è¯·æŸ¥çœ‹ï¼š<a href="https://coolshell.cn/articles/9606.html" target="_blank" rel="noopener noreferrer">https://coolshell.cn/articles/9606.html</a></p><h2 id="hashmap-æœ‰å“ªå‡ ç§å¸¸è§çš„éå†æ–¹å¼" tabindex="-1"><a class="header-anchor" href="#hashmap-æœ‰å“ªå‡ ç§å¸¸è§çš„éå†æ–¹å¼"><span>HashMap æœ‰å“ªå‡ ç§å¸¸è§çš„éå†æ–¹å¼?</span></a></h2><p><a href="https://mp.weixin.qq.com/s/zQBN3UvJDhRTKP6SzcZFKw" target="_blank" rel="noopener noreferrer">HashMap çš„ 7 ç§éå†æ–¹å¼ä¸æ€§èƒ½åˆ†æï¼</a></p><h2 id="concurrenthashmap-å’Œ-hashtable-çš„åŒºåˆ«" tabindex="-1"><a class="header-anchor" href="#concurrenthashmap-å’Œ-hashtable-çš„åŒºåˆ«"><span>ConcurrentHashMap å’Œ Hashtable çš„åŒºåˆ«</span></a></h2><p><code>ConcurrentHashMap</code> å’Œ <code>Hashtable</code> çš„åŒºåˆ«ä¸»è¦ä½“ç°åœ¨å®ç°çº¿ç¨‹å®‰å…¨çš„æ–¹å¼ä¸Šä¸åŒã€‚</p><ul><li><p><strong>åº•å±‚æ•°æ®ç»“æ„ï¼š</strong> JDK1.7 çš„ <code>ConcurrentHashMap</code> åº•å±‚é‡‡ç”¨ <strong>åˆ†æ®µçš„æ•°ç»„+é“¾è¡¨</strong> å®ç°ï¼ŒJDK1.8 é‡‡ç”¨çš„æ•°æ®ç»“æ„è·Ÿ <code>HashMap1.8</code> çš„ç»“æ„ä¸€æ ·ï¼Œæ•°ç»„+é“¾è¡¨/çº¢é»‘äºŒå‰æ ‘ã€‚<code>Hashtable</code> å’Œ JDK1.8 ä¹‹å‰çš„ <code>HashMap</code> çš„åº•å±‚æ•°æ®ç»“æ„ç±»ä¼¼éƒ½æ˜¯é‡‡ç”¨ <strong>æ•°ç»„+é“¾è¡¨</strong> çš„å½¢å¼ï¼Œæ•°ç»„æ˜¯ HashMap çš„ä¸»ä½“ï¼Œé“¾è¡¨åˆ™æ˜¯ä¸»è¦ä¸ºäº†è§£å†³å“ˆå¸Œå†²çªè€Œå­˜åœ¨çš„ï¼›</p></li><li><p><strong>å®ç°çº¿ç¨‹å®‰å…¨çš„æ–¹å¼ï¼ˆé‡è¦ï¼‰ï¼š</strong></p><p>â‘  <strong>åœ¨ JDK1.7 çš„æ—¶å€™ï¼Œ<code>ConcurrentHashMap</code>ï¼ˆåˆ†æ®µé”ï¼‰</strong> å¯¹æ•´ä¸ªæ¡¶æ•°ç»„è¿›è¡Œäº†åˆ†å‰²åˆ†æ®µ(<code>Segment</code>)ï¼Œæ¯ä¸€æŠŠé”åªé”å®¹å™¨å…¶ä¸­ä¸€éƒ¨åˆ†æ•°æ®ï¼Œå¤šçº¿ç¨‹è®¿é—®å®¹å™¨é‡Œä¸åŒæ•°æ®æ®µçš„æ•°æ®ï¼Œå°±ä¸ä¼šå­˜åœ¨é”ç«äº‰ï¼Œæé«˜å¹¶å‘è®¿é—®ç‡ã€‚ <strong>åˆ°äº† JDK1.8 çš„æ—¶å€™å·²ç»æ‘’å¼ƒäº† <code>Segment</code> çš„æ¦‚å¿µï¼Œè€Œæ˜¯ç›´æ¥ç”¨ <code>Node</code> æ•°ç»„+é“¾è¡¨+çº¢é»‘æ ‘çš„æ•°æ®ç»“æ„æ¥å®ç°ï¼Œå¹¶å‘æ§åˆ¶ä½¿ç”¨ <code>synchronized</code> å’Œ CAS æ¥æ“ä½œã€‚ï¼ˆJDK1.6 ä»¥å å¯¹ <code>synchronized</code> é”åšäº†å¾ˆå¤šä¼˜åŒ–ï¼‰</strong> æ•´ä¸ªçœ‹èµ·æ¥å°±åƒæ˜¯ä¼˜åŒ–è¿‡ä¸”çº¿ç¨‹å®‰å…¨çš„ <code>HashMap</code>ï¼Œè™½ç„¶åœ¨ JDK1.8 ä¸­è¿˜èƒ½çœ‹åˆ° <code>Segment</code> çš„æ•°æ®ç»“æ„ï¼Œä½†æ˜¯å·²ç»ç®€åŒ–äº†å±æ€§ï¼Œåªæ˜¯ä¸ºäº†å…¼å®¹æ—§ç‰ˆæœ¬ï¼›</p><p>â‘¡ <strong><code>Hashtable</code>(åŒä¸€æŠŠé”)</strong> :ä½¿ç”¨ <code>synchronized</code> æ¥ä¿è¯çº¿ç¨‹å®‰å…¨ï¼Œæ•ˆç‡éå¸¸ä½ä¸‹ã€‚å½“ä¸€ä¸ªçº¿ç¨‹è®¿é—®åŒæ­¥æ–¹æ³•æ—¶ï¼Œå…¶ä»–çº¿ç¨‹ä¹Ÿè®¿é—®åŒæ­¥æ–¹æ³•ï¼Œå¯èƒ½ä¼šè¿›å…¥é˜»å¡æˆ–è½®è¯¢çŠ¶æ€ï¼Œå¦‚ä½¿ç”¨ put æ·»åŠ å…ƒç´ ï¼Œå¦ä¸€ä¸ªçº¿ç¨‹ä¸èƒ½ä½¿ç”¨ put æ·»åŠ å…ƒç´ ï¼Œä¹Ÿä¸èƒ½ä½¿ç”¨ getï¼Œç«äº‰ä¼šè¶Šæ¥è¶Šæ¿€çƒˆæ•ˆç‡è¶Šä½ã€‚</p></li></ul><p><strong>ä¸¤è€…çš„å¯¹æ¯”å›¾ï¼š</strong></p><p><strong>Hashtable:</strong></p><figure><img src="https://my-blog-to-use.oss-cn-beijing.aliyuncs.com/2019-6/HashTableå…¨è¡¨é”.png" alt="Hashtableå…¨è¡¨é”" tabindex="0" loading="lazy"><figcaption>Hashtableå…¨è¡¨é”</figcaption></figure><p style="text-align:right;font-size:13px;color:gray;">https://www.cnblogs.com/chengxiao/p/6842045.html&gt;</p><p><strong>JDK1.7 çš„ ConcurrentHashMapï¼š</strong></p><figure><img src="https://my-blog-to-use.oss-cn-beijing.aliyuncs.com/2019-6/ConcurrentHashMapåˆ†æ®µé”.jpg" alt="JDK1.7çš„ConcurrentHashMap" tabindex="0" loading="lazy"><figcaption>JDK1.7çš„ConcurrentHashMap</figcaption></figure><p style="text-align:right;font-size:13px;color:gray;">https://www.cnblogs.com/chengxiao/p/6842045.html&gt;</p><p><strong>JDK1.8 çš„ ConcurrentHashMapï¼š</strong></p><figure><img src="https://www.javadoop.com/blogimages/map/4.png" alt="Java8 ConcurrentHashMap å­˜å‚¨ç»“æ„ï¼ˆå›¾ç‰‡æ¥è‡ª javadoopï¼‰" tabindex="0" loading="lazy"><figcaption>Java8 ConcurrentHashMap å­˜å‚¨ç»“æ„ï¼ˆå›¾ç‰‡æ¥è‡ª javadoopï¼‰</figcaption></figure><p>JDK1.8 çš„ <code>ConcurrentHashMap</code> ä¸å†æ˜¯ <strong>Segment æ•°ç»„ + HashEntry æ•°ç»„ + é“¾è¡¨</strong>ï¼Œè€Œæ˜¯ <strong>Node æ•°ç»„ + é“¾è¡¨ / çº¢é»‘æ ‘</strong>ã€‚ä¸è¿‡ï¼ŒNode åªèƒ½ç”¨äºé“¾è¡¨çš„æƒ…å†µï¼Œçº¢é»‘æ ‘çš„æƒ…å†µéœ€è¦ä½¿ç”¨ <strong><code>TreeNode</code></strong>ã€‚å½“å†²çªé“¾è¡¨è¾¾åˆ°ä¸€å®šé•¿åº¦æ—¶ï¼Œé“¾è¡¨ä¼šè½¬æ¢æˆçº¢é»‘æ ‘ã€‚</p><h2 id="concurrenthashmap-çº¿ç¨‹å®‰å…¨çš„å…·ä½“å®ç°æ–¹å¼-åº•å±‚å…·ä½“å®ç°" tabindex="-1"><a class="header-anchor" href="#concurrenthashmap-çº¿ç¨‹å®‰å…¨çš„å…·ä½“å®ç°æ–¹å¼-åº•å±‚å…·ä½“å®ç°"><span>ConcurrentHashMap çº¿ç¨‹å®‰å…¨çš„å…·ä½“å®ç°æ–¹å¼/åº•å±‚å…·ä½“å®ç°</span></a></h2><h3 id="jdk1-7-ä¸Šé¢æœ‰ç¤ºæ„å›¾" tabindex="-1"><a class="header-anchor" href="#jdk1-7-ä¸Šé¢æœ‰ç¤ºæ„å›¾"><span>JDK1.7ï¼ˆä¸Šé¢æœ‰ç¤ºæ„å›¾ï¼‰</span></a></h3><p>é¦–å…ˆå°†æ•°æ®åˆ†ä¸ºä¸€æ®µä¸€æ®µçš„å­˜å‚¨ï¼Œç„¶åç»™æ¯ä¸€æ®µæ•°æ®é…ä¸€æŠŠé”ï¼Œå½“ä¸€ä¸ªçº¿ç¨‹å ç”¨é”è®¿é—®å…¶ä¸­ä¸€ä¸ªæ®µæ•°æ®æ—¶ï¼Œå…¶ä»–æ®µçš„æ•°æ®ä¹Ÿèƒ½è¢«å…¶ä»–çº¿ç¨‹è®¿é—®ã€‚</p><p><strong><code>ConcurrentHashMap</code> æ˜¯ç”± <code>Segment</code> æ•°ç»„ç»“æ„å’Œ <code>HashEntry</code> æ•°ç»„ç»“æ„ç»„æˆ</strong>ã€‚</p><p>Segment å®ç°äº† <code>ReentrantLock</code>,æ‰€ä»¥ <code>Segment</code> æ˜¯ä¸€ç§å¯é‡å…¥é”ï¼Œæ‰®æ¼”é”çš„è§’è‰²ã€‚<code>HashEntry</code> ç”¨äºå­˜å‚¨é”®å€¼å¯¹æ•°æ®ã€‚</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="--shiki-light:#393a34;--shiki-dark:#e1e4e8;--shiki-light-bg:#ffffff;--shiki-dark-bg:#24292e;"><pre class="shiki shiki-themes vitesse-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#F97583;">static</span><span style="--shiki-light:#AB5959;--shiki-dark:#F97583;"> class</span><span style="--shiki-light:#2E8F82;--shiki-dark:#B392F0;"> Segment</span><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#AB5959;--shiki-dark:#F97583;">K</span><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#AB5959;--shiki-dark:#F97583;">V</span><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;">&gt;</span><span style="--shiki-light:#AB5959;--shiki-dark:#F97583;"> extends</span><span style="--shiki-light:#59873A;--shiki-dark:#B392F0;"> ReentrantLock</span><span style="--shiki-light:#AB5959;--shiki-dark:#F97583;"> implements</span><span style="--shiki-light:#59873A;--shiki-dark:#B392F0;"> Serializable</span><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸€ä¸ª <code>ConcurrentHashMap</code> é‡ŒåŒ…å«ä¸€ä¸ª <code>Segment</code> æ•°ç»„ã€‚<code>Segment</code> çš„ç»“æ„å’Œ <code>HashMap</code> ç±»ä¼¼ï¼Œæ˜¯ä¸€ç§æ•°ç»„å’Œé“¾è¡¨ç»“æ„ï¼Œä¸€ä¸ª <code>Segment</code> åŒ…å«ä¸€ä¸ª <code>HashEntry</code> æ•°ç»„ï¼Œæ¯ä¸ª <code>HashEntry</code> æ˜¯ä¸€ä¸ªé“¾è¡¨ç»“æ„çš„å…ƒç´ ï¼Œæ¯ä¸ª <code>Segment</code> å®ˆæŠ¤ç€ä¸€ä¸ª <code>HashEntry</code> æ•°ç»„é‡Œçš„å…ƒç´ ï¼Œå½“å¯¹ <code>HashEntry</code> æ•°ç»„çš„æ•°æ®è¿›è¡Œä¿®æ”¹æ—¶ï¼Œå¿…é¡»é¦–å…ˆè·å¾—å¯¹åº”çš„ <code>Segment</code> çš„é”ã€‚</p><h3 id="jdk1-8-ä¸Šé¢æœ‰ç¤ºæ„å›¾" tabindex="-1"><a class="header-anchor" href="#jdk1-8-ä¸Šé¢æœ‰ç¤ºæ„å›¾"><span>JDK1.8 ï¼ˆä¸Šé¢æœ‰ç¤ºæ„å›¾ï¼‰</span></a></h3><p><code>ConcurrentHashMap</code> å–æ¶ˆäº† <code>Segment</code> åˆ†æ®µé”ï¼Œé‡‡ç”¨ CAS å’Œ <code>synchronized</code> æ¥ä¿è¯å¹¶å‘å®‰å…¨ã€‚æ•°æ®ç»“æ„è·Ÿ HashMap1.8 çš„ç»“æ„ç±»ä¼¼ï¼Œæ•°ç»„+é“¾è¡¨/çº¢é»‘äºŒå‰æ ‘ã€‚Java 8 åœ¨é“¾è¡¨é•¿åº¦è¶…è¿‡ä¸€å®šé˜ˆå€¼ï¼ˆ8ï¼‰æ—¶å°†é“¾è¡¨ï¼ˆå¯»å€æ—¶é—´å¤æ‚åº¦ä¸º O(N)ï¼‰è½¬æ¢ä¸ºçº¢é»‘æ ‘ï¼ˆå¯»å€æ—¶é—´å¤æ‚åº¦ä¸º O(log(N))ï¼‰</p><p><code>synchronized</code> åªé”å®šå½“å‰é“¾è¡¨æˆ–çº¢é»‘äºŒå‰æ ‘çš„é¦–èŠ‚ç‚¹ï¼Œè¿™æ ·åªè¦ hash ä¸å†²çªï¼Œå°±ä¸ä¼šäº§ç”Ÿå¹¶å‘ï¼Œæ•ˆç‡åˆæå‡ N å€ã€‚</p><h2 id="æ±‚å¤§äºç­‰äºæŒ‡å®šæ•°çš„æœ€å°çš„äºŒæ¬¡å¹‚" tabindex="-1"><a class="header-anchor" href="#æ±‚å¤§äºç­‰äºæŒ‡å®šæ•°çš„æœ€å°çš„äºŒæ¬¡å¹‚"><span>æ±‚å¤§äºç­‰äºæŒ‡å®šæ•°çš„æœ€å°çš„äºŒæ¬¡å¹‚ï¼Ÿ</span></a></h2><p><code>HashMap</code>çš„<code>tableSizeFor</code>æ–¹æ³•èƒ½è¡ç”Ÿå‡ºæ¥ä¸€ä¸ªå¾ˆæœ‰æ„æ€çš„é—®é¢˜ã€‚è¯¥æ–¹æ³•å†…å®¹å¦‚ä¸‹ï¼š</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="--shiki-light:#393a34;--shiki-dark:#e1e4e8;--shiki-light-bg:#ffffff;--shiki-dark-bg:#24292e;"><pre class="shiki shiki-themes vitesse-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#F97583;">static</span><span style="--shiki-light:#AB5959;--shiki-dark:#F97583;"> final</span><span style="--shiki-light:#AB5959;--shiki-dark:#F97583;"> int</span><span style="--shiki-light:#59873A;--shiki-dark:#B392F0;"> tableSizeFor</span><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#AB5959;--shiki-dark:#F97583;">int</span><span style="--shiki-light:#393A34;--shiki-dark:#E1E4E8;"> cap</span><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;">)</span><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#F97583;">    int</span><span style="--shiki-light:#B07D48;--shiki-dark:#E1E4E8;"> n</span><span style="--shiki-light:#999999;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#393A34;--shiki-dark:#E1E4E8;"> cap </span><span style="--shiki-light:#AB5959;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#2F798A;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#E1E4E8;">    n </span><span style="--shiki-light:#999999;--shiki-dark:#F97583;">|=</span><span style="--shiki-light:#393A34;--shiki-dark:#E1E4E8;"> n </span><span style="--shiki-light:#AB5959;--shiki-dark:#F97583;">&gt;&gt;&gt;</span><span style="--shiki-light:#2F798A;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#E1E4E8;">    n </span><span style="--shiki-light:#999999;--shiki-dark:#F97583;">|=</span><span style="--shiki-light:#393A34;--shiki-dark:#E1E4E8;"> n </span><span style="--shiki-light:#AB5959;--shiki-dark:#F97583;">&gt;&gt;&gt;</span><span style="--shiki-light:#2F798A;--shiki-dark:#79B8FF;"> 2</span><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#E1E4E8;">    n </span><span style="--shiki-light:#999999;--shiki-dark:#F97583;">|=</span><span style="--shiki-light:#393A34;--shiki-dark:#E1E4E8;"> n </span><span style="--shiki-light:#AB5959;--shiki-dark:#F97583;">&gt;&gt;&gt;</span><span style="--shiki-light:#2F798A;--shiki-dark:#79B8FF;"> 4</span><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#E1E4E8;">    n </span><span style="--shiki-light:#999999;--shiki-dark:#F97583;">|=</span><span style="--shiki-light:#393A34;--shiki-dark:#E1E4E8;"> n </span><span style="--shiki-light:#AB5959;--shiki-dark:#F97583;">&gt;&gt;&gt;</span><span style="--shiki-light:#2F798A;--shiki-dark:#79B8FF;"> 8</span><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#E1E4E8;">    n </span><span style="--shiki-light:#999999;--shiki-dark:#F97583;">|=</span><span style="--shiki-light:#393A34;--shiki-dark:#E1E4E8;"> n </span><span style="--shiki-light:#AB5959;--shiki-dark:#F97583;">&gt;&gt;&gt;</span><span style="--shiki-light:#2F798A;--shiki-dark:#79B8FF;"> 16</span><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#393A34;--shiki-dark:#E1E4E8;">n </span><span style="--shiki-light:#AB5959;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#2F798A;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;">)</span><span style="--shiki-light:#1E754F;--shiki-dark:#F97583;"> ?</span><span style="--shiki-light:#2F798A;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#1E754F;--shiki-dark:#F97583;"> :</span><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#393A34;--shiki-dark:#E1E4E8;">n </span><span style="--shiki-light:#AB5959;--shiki-dark:#F97583;">&gt;=</span><span style="--shiki-light:#393A34;--shiki-dark:#E1E4E8;"> MAXIMUM_CAPACITY</span><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;">)</span><span style="--shiki-light:#1E754F;--shiki-dark:#F97583;"> ?</span><span style="--shiki-light:#393A34;--shiki-dark:#E1E4E8;"> MAXIMUM_CAPACITY </span><span style="--shiki-light:#1E754F;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#393A34;--shiki-dark:#E1E4E8;"> n </span><span style="--shiki-light:#AB5959;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#2F798A;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æˆ‘ä»¬å‡è®¾ <strong>cap = 321</strong>ï¼Œé‚£ä¹ˆn = 320ï¼ŒäºŒè¿›åˆ¶è¡¨è¾¾ä¸ºï¼š0001 0100 0000</p><p>n |= n &gt;&gt;&gt; 1ï¼šn&gt;&gt;&gt;1æ„æ€æ˜¯æ— ç¬¦å·å³ç§»1ä½ï¼Œç»“æœä¸º 1010 0000ã€‚ä¸è¿ç®—åç»“æœï¼š0001 1110 0000</p><p>n |= n &gt;&gt;&gt; 2ï¼šn&gt;&gt;&gt;2æ„æ€æ˜¯æ— ç¬¦å·å³ç§»2ä½ï¼Œç»“æœä¸º 0111 1000ã€‚ä¸è¿ç®—åç»“æœï¼š0001 1111 1000</p><p>n |= n &gt;&gt;&gt; 4ï¼šn&gt;&gt;&gt;4æ„æ€æ˜¯æ— ç¬¦å·å³ç§»4ä½ï¼Œç»“æœä¸º 0001 1111ã€‚ä¸è¿ç®—åç»“æœï¼š0001 1111 1111</p><p>n |= n &gt;&gt;&gt; 8ï¼šn&gt;&gt;&gt;8æ„æ€æ˜¯æ— ç¬¦å·å³ç§»8ä½ï¼Œç»“æœä¸º 0000 0001ã€‚ä¸è¿ç®—åç»“æœï¼š0001 1111 1111</p><p>n |= n &gt;&gt;&gt; 16ï¼šn&gt;&gt;&gt;8æ„æ€æ˜¯æ— ç¬¦å·å³ç§»16ä½ï¼Œç»“æœä¸º 0000 0000ã€‚ä¸è¿ç®—åç»“æœï¼š0001 1111 1111</p><p>æœ€ç»ˆç»“æœä¸ºï¼š0001 1111 1111ï¼Œ10è¿›åˆ¶è¡¨ç¤ºä¸º511ã€‚æœ€ç»ˆç»“æœ+1ï¼Œä¸º512ã€‚å³è¡¨ç¤ºæœ€ç»ˆç»“æœã€‚</p><p>å¯ä»¥çœ‹åˆ°ï¼Œç®—æ³•é‡Œä½è¿ç®—çš„ä½œç”¨ï¼Œæ˜¯æŠŠåŸå§‹æ•°æ®é‡Œçš„1ï¼Œå¤åˆ¶åˆ°æ¯ä¸ªä½ä½ä¸Šã€‚æœ€åå†åŠ 1ï¼Œæ•´ä¸ªäºŒè¿›åˆ¶å°±åªåŒ…å«1ä¸ª1ï¼Œå³ç­‰äºäºŒæ¬¡å¹‚ã€‚</p><p>é‚£å¼€å§‹ä¸ºä»€ä¹ˆè¦å…ˆå‡1å‘¢ï¼Ÿå¦‚æœç»™çš„å…ƒç´ æ•°æ®å°±æ˜¯äºŒæ¬¡å¹‚ï¼Œå¦‚1024ï¼Œä¸å‡1å°±ä¼šå¾—åˆ°2048ï¼š</p><p>0100 0000 0000 -&gt; 0110 0000 0000 -&gt; 0111 1000 0000 -&gt; 0111 1111 1000 -&gt; 0111 1111 1111 -&gt; 0111 1111 1111 -&gt; 1000 0000 0000ï¼Œç»“æœä¸º2048ã€‚</p><p>è¿™ä¸ªæ–¹æ³•åŸæœ¬æ˜¯ç¡®å®š<code>HashMap</code>å†…éƒ¨æ•°å€¼çš„é•¿åº¦çš„ï¼Œå¦‚æœæ°å¥½ç»™äº†ä¸€ä¸ªäºŒæ¬¡å¹‚ï¼Œé‚£å°±éœ€è¦è¿”å›å…¶æœ¬èº«ã€‚å› æ­¤ç®—æ³•è¿™æ ·è®¾è®¡ã€‚</p><p>é‚£ä¸ºä»€ä¹ˆè¦åˆ†åˆ«è¿›è¡Œ1,2,4,8,16æ¬¡æ— ç¬¦å·å³ç§»å‘¢ï¼Ÿè¿™æ ·æ°å¥½èƒ½è¦†ç›–intçš„æœ€å¤§å€¼ã€‚</p>`,98),t=[e];function l(k,p){return a(),i("div",null,t)}const g=s(h,[["render",l],["__file","index.html.vue"]]),E=JSON.parse('{"path":"/01java/20coll/map/","title":"Map","lang":"zh-CN","frontmatter":{"title":"Map","order":15,"date":"2022-03-04T21:03:14.000Z","permalink":"/01java/20coll/map/","icon":"wenzhang","category":["å­¦ä¹ ç¬”è®°","Javaå®¹å™¨"],"tag":["åŸºç¡€"],"description":"ç›¸å…³å‚è€ƒæ–‡ç« ğŸ‰ çº¢é»‘æ ‘æ·±å…¥å‰–æåŠJavaå®ç° ä»¥ä¸‹å†…å®¹å‡ºè‡ªJavaGuideã€‚ HashMap å’Œ Hashtable çš„åŒºåˆ« çº¿ç¨‹æ˜¯å¦å®‰å…¨ï¼š HashMap æ˜¯éçº¿ç¨‹å®‰å…¨çš„ï¼ŒHashtable æ˜¯çº¿ç¨‹å®‰å…¨çš„,å› ä¸º Hashtable å†…éƒ¨çš„æ–¹æ³•åŸºæœ¬éƒ½ç»è¿‡synchronized ä¿®é¥°ã€‚ï¼ˆå¦‚æœä½ è¦ä¿è¯çº¿ç¨‹å®‰å…¨çš„è¯å°±ä½¿ç”¨ ConcurrentHashM...","head":[["meta",{"property":"og:url","content":"https://i.iyes.life/01java/20coll/map/"}],["meta",{"property":"og:site_name","content":"Mr.He"}],["meta",{"property":"og:title","content":"Map"}],["meta",{"property":"og:description","content":"ç›¸å…³å‚è€ƒæ–‡ç« ğŸ‰ çº¢é»‘æ ‘æ·±å…¥å‰–æåŠJavaå®ç° ä»¥ä¸‹å†…å®¹å‡ºè‡ªJavaGuideã€‚ HashMap å’Œ Hashtable çš„åŒºåˆ« çº¿ç¨‹æ˜¯å¦å®‰å…¨ï¼š HashMap æ˜¯éçº¿ç¨‹å®‰å…¨çš„ï¼ŒHashtable æ˜¯çº¿ç¨‹å®‰å…¨çš„,å› ä¸º Hashtable å†…éƒ¨çš„æ–¹æ³•åŸºæœ¬éƒ½ç»è¿‡synchronized ä¿®é¥°ã€‚ï¼ˆå¦‚æœä½ è¦ä¿è¯çº¿ç¨‹å®‰å…¨çš„è¯å°±ä½¿ç”¨ ConcurrentHashM..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:image","content":"https://my-blog-to-use.oss-cn-beijing.aliyuncs.com/2019-6/HashTableå…¨è¡¨é”.png"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2024-08-18T06:12:12.000Z"}],["meta",{"property":"article:author","content":"Mr.He"}],["meta",{"property":"article:tag","content":"åŸºç¡€"}],["meta",{"property":"article:published_time","content":"2022-03-04T21:03:14.000Z"}],["meta",{"property":"article:modified_time","content":"2024-08-18T06:12:12.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"Map\\",\\"image\\":[\\"https://my-blog-to-use.oss-cn-beijing.aliyuncs.com/2019-6/HashTableå…¨è¡¨é”.png\\",\\"https://my-blog-to-use.oss-cn-beijing.aliyuncs.com/2019-6/ConcurrentHashMapåˆ†æ®µé”.jpg\\",\\"https://www.javadoop.com/blogimages/map/4.png\\"],\\"datePublished\\":\\"2022-03-04T21:03:14.000Z\\",\\"dateModified\\":\\"2024-08-18T06:12:12.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"Mr.He\\",\\"url\\":\\"https://i.iyes.life\\"}]}"]]},"headers":[{"level":2,"title":"HashMap å’Œ Hashtable çš„åŒºåˆ«","slug":"hashmap-å’Œ-hashtable-çš„åŒºåˆ«","link":"#hashmap-å’Œ-hashtable-çš„åŒºåˆ«","children":[]},{"level":2,"title":"HashMap å’Œ HashSet åŒºåˆ«","slug":"hashmap-å’Œ-hashset-åŒºåˆ«","link":"#hashmap-å’Œ-hashset-åŒºåˆ«","children":[]},{"level":2,"title":"HashMap å’Œ TreeMap åŒºåˆ«","slug":"hashmap-å’Œ-treemap-åŒºåˆ«","link":"#hashmap-å’Œ-treemap-åŒºåˆ«","children":[]},{"level":2,"title":"HashSet å¦‚ä½•æ£€æŸ¥é‡å¤","slug":"hashset-å¦‚ä½•æ£€æŸ¥é‡å¤","link":"#hashset-å¦‚ä½•æ£€æŸ¥é‡å¤","children":[]},{"level":2,"title":"HashMap çš„åº•å±‚å®ç°","slug":"hashmap-çš„åº•å±‚å®ç°","link":"#hashmap-çš„åº•å±‚å®ç°","children":[{"level":3,"title":"JDK1.8 ä¹‹å‰","slug":"jdk1-8-ä¹‹å‰","link":"#jdk1-8-ä¹‹å‰","children":[]},{"level":3,"title":"JDK1.8 ä¹‹å","slug":"jdk1-8-ä¹‹å","link":"#jdk1-8-ä¹‹å","children":[]}]},{"level":2,"title":"HashMap çš„é•¿åº¦ä¸ºä»€ä¹ˆæ˜¯ 2 çš„å¹‚æ¬¡æ–¹","slug":"hashmap-çš„é•¿åº¦ä¸ºä»€ä¹ˆæ˜¯-2-çš„å¹‚æ¬¡æ–¹","link":"#hashmap-çš„é•¿åº¦ä¸ºä»€ä¹ˆæ˜¯-2-çš„å¹‚æ¬¡æ–¹","children":[]},{"level":2,"title":"HashMap å¤šçº¿ç¨‹æ“ä½œå¯¼è‡´æ­»å¾ªç¯é—®é¢˜","slug":"hashmap-å¤šçº¿ç¨‹æ“ä½œå¯¼è‡´æ­»å¾ªç¯é—®é¢˜","link":"#hashmap-å¤šçº¿ç¨‹æ“ä½œå¯¼è‡´æ­»å¾ªç¯é—®é¢˜","children":[]},{"level":2,"title":"HashMap æœ‰å“ªå‡ ç§å¸¸è§çš„éå†æ–¹å¼?","slug":"hashmap-æœ‰å“ªå‡ ç§å¸¸è§çš„éå†æ–¹å¼","link":"#hashmap-æœ‰å“ªå‡ ç§å¸¸è§çš„éå†æ–¹å¼","children":[]},{"level":2,"title":"ConcurrentHashMap å’Œ Hashtable çš„åŒºåˆ«","slug":"concurrenthashmap-å’Œ-hashtable-çš„åŒºåˆ«","link":"#concurrenthashmap-å’Œ-hashtable-çš„åŒºåˆ«","children":[]},{"level":2,"title":"ConcurrentHashMap çº¿ç¨‹å®‰å…¨çš„å…·ä½“å®ç°æ–¹å¼/åº•å±‚å…·ä½“å®ç°","slug":"concurrenthashmap-çº¿ç¨‹å®‰å…¨çš„å…·ä½“å®ç°æ–¹å¼-åº•å±‚å…·ä½“å®ç°","link":"#concurrenthashmap-çº¿ç¨‹å®‰å…¨çš„å…·ä½“å®ç°æ–¹å¼-åº•å±‚å…·ä½“å®ç°","children":[{"level":3,"title":"JDK1.7ï¼ˆä¸Šé¢æœ‰ç¤ºæ„å›¾ï¼‰","slug":"jdk1-7-ä¸Šé¢æœ‰ç¤ºæ„å›¾","link":"#jdk1-7-ä¸Šé¢æœ‰ç¤ºæ„å›¾","children":[]},{"level":3,"title":"JDK1.8 ï¼ˆä¸Šé¢æœ‰ç¤ºæ„å›¾ï¼‰","slug":"jdk1-8-ä¸Šé¢æœ‰ç¤ºæ„å›¾","link":"#jdk1-8-ä¸Šé¢æœ‰ç¤ºæ„å›¾","children":[]}]},{"level":2,"title":"æ±‚å¤§äºç­‰äºæŒ‡å®šæ•°çš„æœ€å°çš„äºŒæ¬¡å¹‚ï¼Ÿ","slug":"æ±‚å¤§äºç­‰äºæŒ‡å®šæ•°çš„æœ€å°çš„äºŒæ¬¡å¹‚","link":"#æ±‚å¤§äºç­‰äºæŒ‡å®šæ•°çš„æœ€å°çš„äºŒæ¬¡å¹‚","children":[]}],"git":{"createdTime":1664722755000,"updatedTime":1723961532000,"contributors":[{"name":"jayxiaohe","email":"495302067@qq.com","commits":1},{"name":"jayxiaohe","email":"hept//github0712","commits":1}]},"readingTime":{"minutes":14.2,"words":4259},"filePathRelative":"01java/20coll/15map.md","localizedDate":"2022å¹´3æœˆ5æ—¥","autoDesc":true}');export{g as comp,E as data};
